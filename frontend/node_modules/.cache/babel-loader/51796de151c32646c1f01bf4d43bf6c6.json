{"ast":null,"code":"import { ADD_MESSAGE, GET_MESSAGE_LIST } from \"./messageActionsTypes\";\nimport axios from \"axios\";\nexport const addMessage = (username, message) => ({\n  type: ADD_MESSAGE,\n  username: username,\n  message: message\n});\nexport const sendMessage = (message, sockJsClient) => {\n  return () => {\n    sockJsClient.sendMessage('/app/user-all', JSON.stringify(message));\n  };\n};\nexport const fetchMessageList = messageList => ({\n  type: GET_MESSAGE_LIST,\n  messageList: messageList\n});\n\nconst formatMessages = messageList => {\n  const formattedMessageList = [];\n\n  for (const message of messageList) {\n    formattedMessageList.push({\n      speaker: message.speaker.username,\n      guest: message.guest.pseudo,\n      message: message.text\n    });\n  }\n\n  return formattedMessageList;\n};\n\nexport const getMessageList = chatId => {\n  return async dispatch => {\n    try {\n      const response = await axios.get(`http://localhost:8081/api/messages/chat/${chatId}`);\n      const messageList = response.data;\n      const formattedMsgList = formatMessages(messageList);\n      console.log(\"get message list\");\n      console.log(formattedMsgList);\n      dispatch(fetchMessageList(formattedMsgList));\n    } catch (e) {\n      console.log(e);\n      return false;\n    }\n  };\n};","map":{"version":3,"sources":["C:/Users/micha/Projets/masterpiece/frontend/src/Message/messageActions.js"],"names":["ADD_MESSAGE","GET_MESSAGE_LIST","axios","addMessage","username","message","type","sendMessage","sockJsClient","JSON","stringify","fetchMessageList","messageList","formatMessages","formattedMessageList","push","speaker","guest","pseudo","text","getMessageList","chatId","dispatch","response","get","data","formattedMsgList","console","log","e"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,gBAAtB,QAA8C,uBAA9C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,UAAU,GAAG,CAACC,QAAD,EAAWC,OAAX,MAAwB;AAC9CC,EAAAA,IAAI,EAAEN,WADwC;AAE9CI,EAAAA,QAAQ,EAAEA,QAFoC;AAG9CC,EAAAA,OAAO,EAAEA;AAHqC,CAAxB,CAAnB;AAMP,OAAO,MAAME,WAAW,GAAG,CAACF,OAAD,EAAUG,YAAV,KAA2B;AAClD,SAAO,MAAM;AACTA,IAAAA,YAAY,CAACD,WAAb,CAAyB,eAAzB,EAA0CE,IAAI,CAACC,SAAL,CAAeL,OAAf,CAA1C;AACH,GAFD;AAGH,CAJM;AAMP,OAAO,MAAMM,gBAAgB,GAAIC,WAAD,KAAkB;AAC9CN,EAAAA,IAAI,EAAEL,gBADwC;AAE9CW,EAAAA,WAAW,EAAEA;AAFiC,CAAlB,CAAzB;;AAKP,MAAMC,cAAc,GAAID,WAAD,IAAiB;AACpC,QAAME,oBAAoB,GAAG,EAA7B;;AAEA,OAAK,MAAMT,OAAX,IAAsBO,WAAtB,EAAmC;AAC/BE,IAAAA,oBAAoB,CAACC,IAArB,CAA0B;AAAEC,MAAAA,OAAO,EAAEX,OAAO,CAACW,OAAR,CAAgBZ,QAA3B;AAAqCa,MAAAA,KAAK,EAAEZ,OAAO,CAACY,KAAR,CAAcC,MAA1D;AAAkEb,MAAAA,OAAO,EAAEA,OAAO,CAACc;AAAnF,KAA1B;AACH;;AAED,SAAOL,oBAAP;AACH,CARD;;AAUA,OAAO,MAAMM,cAAc,GAAIC,MAAD,IAAY;AACtC,SAAO,MAAOC,QAAP,IAAoB;AACvB,QAAI;AACA,YAAMC,QAAQ,GAAG,MAAMrB,KAAK,CAACsB,GAAN,CAAW,2CAA0CH,MAAO,EAA5D,CAAvB;AACA,YAAMT,WAAW,GAAGW,QAAQ,CAACE,IAA7B;AACA,YAAMC,gBAAgB,GAAGb,cAAc,CAACD,WAAD,CAAvC;AACAe,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYF,gBAAZ;AACAJ,MAAAA,QAAQ,CAACX,gBAAgB,CAACe,gBAAD,CAAjB,CAAR;AACH,KAPD,CAOE,OAAMG,CAAN,EAAS;AACPF,MAAAA,OAAO,CAACC,GAAR,CAAYC,CAAZ;AACA,aAAO,KAAP;AACH;AACJ,GAZD;AAaH,CAdM","sourcesContent":["import { ADD_MESSAGE, GET_MESSAGE_LIST } from \"./messageActionsTypes\"\r\nimport axios from \"axios\";\r\n\r\nexport const addMessage = (username, message) => ({\r\n    type: ADD_MESSAGE,\r\n    username: username,\r\n    message: message\r\n})\r\n\r\nexport const sendMessage = (message, sockJsClient) => {\r\n    return () => {\r\n        sockJsClient.sendMessage('/app/user-all', JSON.stringify(message));\r\n    }\r\n}\r\n\r\nexport const fetchMessageList = (messageList) => ({\r\n    type: GET_MESSAGE_LIST,\r\n    messageList: messageList\r\n})\r\n\r\nconst formatMessages = (messageList) => {\r\n    const formattedMessageList = [];\r\n\r\n    for (const message of messageList) {\r\n        formattedMessageList.push({ speaker: message.speaker.username, guest: message.guest.pseudo, message: message.text})\r\n    }\r\n\r\n    return formattedMessageList;\r\n}\r\n\r\nexport const getMessageList = (chatId) => {\r\n    return async (dispatch) => {\r\n        try {\r\n            const response = await axios.get(`http://localhost:8081/api/messages/chat/${chatId}`);\r\n            const messageList = response.data\r\n            const formattedMsgList = formatMessages(messageList);\r\n            console.log(\"get message list\");\r\n            console.log(formattedMsgList);\r\n            dispatch(fetchMessageList(formattedMsgList));\r\n        } catch(e) {           \r\n            console.log(e);\r\n            return false;\r\n        }\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}