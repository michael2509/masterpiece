{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\micha\\\\Projets\\\\masterpiece\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\micha\\\\Projets\\\\masterpiece\\\\frontend\\\\src\\\\Room\\\\SingleRoom\\\\CreateGuest.jsx\";\nimport React from 'react';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport * as Yup from \"yup\";\nimport axios from \"axios\";\nimport { withFormik } from 'formik';\nimport listServerErrors from '../../global/functions/listServerErrors';\n\nfunction CreateGuestForm(props) {\n  const values = props.values,\n        touched = props.touched,\n        errors = props.errors,\n        handleChange = props.handleChange,\n        handleBlur = props.handleBlur,\n        handleSubmit = props.handleSubmit,\n        open = props.open;\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }, React.createElement(Dialog, {\n    open: open,\n    \"aria-labelledby\": \"form-dialog-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }, React.createElement(DialogTitle, {\n    id: \"form-dialog-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }, \"Choix du pseudo\"), React.createElement(DialogContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }, React.createElement(DialogContentText, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, \"Veuillez choisir le pseudo que vous utiliserez dans ce salon.\"), React.createElement(TextField, {\n    id: \"pseudo\",\n    label: \"Pseudo\",\n    type: \"text\",\n    value: values.pseudo,\n    onChange: handleChange,\n    onBlur: handleBlur,\n    helperText: touched.pseudo ? errors.pseudo : \"\",\n    error: touched.pseudo && Boolean(errors.pseudo),\n    variant: \"outlined\",\n    margin: \"normal\",\n    fullWidth: true,\n    autoFocus: true,\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34\n    },\n    __self: this\n  })), React.createElement(DialogActions, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, React.createElement(Button, {\n    onClick: handleSubmit,\n    color: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, \"Valider\"))));\n}\n\nconst CreateGuest = withFormik({\n  mapPropsToValues: ({\n    pseudo\n  }) => {\n    return {\n      pseudo: pseudo || \"\"\n    };\n  },\n  validationSchema: Yup.object().shape({\n    pseudo: Yup.string().required(\"Entrez un pseudo\")\n  }),\n  handleSubmit: async (values, {\n    props,\n    resetForm\n  }) => {\n    const roomId = props.roomId,\n          openNotif = props.openNotif,\n          closeForm = props.closeForm,\n          setGuestId = props.setGuestId;\n\n    const guest = _objectSpread({}, values, {\n      chatId: roomId\n    });\n\n    const guestjson = JSON.stringify(guest);\n    console.log(guest);\n\n    try {\n      // create guest user\n      const response = await axios.post(\"http://localhost:8081/api/guests\", guestjson, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      console.log(response);\n      const savedGuest = response.data; // Clean form\n\n      resetForm(); // Show welcome notif\n\n      openNotif(`Bienvenue ${guest.pseudo}, vous pouvez maintenant envoyer vos messages dans ce salon`, \"success\"); // close choose pseudo form\n\n      closeForm(); // Set guest peudo in redux state\n\n      setGuestId(savedGuest.id);\n    } catch (e) {\n      // Show errors in notif\n      const errorList = listServerErrors(e.response.status, e.response.data);\n      openNotif(errorList, \"error\");\n    }\n  }\n})(CreateGuestForm);\nexport default CreateGuest;","map":{"version":3,"sources":["C:/Users/micha/Projets/masterpiece/frontend/src/Room/SingleRoom/CreateGuest.jsx"],"names":["React","Button","TextField","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Yup","axios","withFormik","listServerErrors","CreateGuestForm","props","values","touched","errors","handleChange","handleBlur","handleSubmit","open","pseudo","Boolean","CreateGuest","mapPropsToValues","validationSchema","object","shape","string","required","resetForm","roomId","openNotif","closeForm","setGuestId","guest","chatId","guestjson","JSON","stringify","console","log","response","post","headers","savedGuest","data","id","e","errorList","status"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport * as Yup from \"yup\";\r\nimport axios from \"axios\";\r\nimport { withFormik } from 'formik';\r\nimport listServerErrors from '../../global/functions/listServerErrors';\r\n\r\nfunction CreateGuestForm(props) {\r\n\r\n  const {\r\n    values,\r\n    touched,\r\n    errors,\r\n    handleChange,\r\n    handleBlur,\r\n    handleSubmit,\r\n    open\r\n  } = props;\r\n\r\n  return (\r\n    <div>\r\n      <Dialog open={open} aria-labelledby=\"form-dialog-title\">\r\n        <DialogTitle id=\"form-dialog-title\">Choix du pseudo</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Veuillez choisir le pseudo que vous utiliserez dans ce salon.\r\n          </DialogContentText>\r\n          <TextField\r\n                    id=\"pseudo\"\r\n                    label=\"Pseudo\"\r\n                    type=\"text\"\r\n                    value={values.pseudo}\r\n                    onChange={handleChange}\r\n                    onBlur={handleBlur}\r\n                    helperText={touched.pseudo ? errors.pseudo : \"\"}\r\n                    error={touched.pseudo && Boolean(errors.pseudo)}\r\n                    variant=\"outlined\"\r\n                    margin=\"normal\"\r\n                    fullWidth\r\n                    autoFocus\r\n                    required\r\n                />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleSubmit} color=\"primary\">\r\n            Valider\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst CreateGuest = withFormik({\r\n  mapPropsToValues: ({\r\n      pseudo\r\n  }) => {\r\n      return {\r\n          pseudo: pseudo || \"\"\r\n      };\r\n  },\r\n\r\n  validationSchema: Yup.object().shape({\r\n      pseudo: Yup.string()\r\n          .required(\"Entrez un pseudo\")\r\n  }),\r\n\r\n  handleSubmit: async (values, { props, resetForm }) => {\r\n\r\n      const { roomId, openNotif, closeForm, setGuestId } = props;\r\n      const guest = {...values, chatId: roomId}\r\n      const guestjson = JSON.stringify(guest);\r\n\r\n      console.log(guest);\r\n\r\n      try {\r\n        // create guest user\r\n        const response = await axios.post(\r\n          \"http://localhost:8081/api/guests\",\r\n          guestjson,\r\n          { headers: { 'Content-Type': 'application/json' } }\r\n        )\r\n\r\n        console.log(response);\r\n        const savedGuest = response.data\r\n\r\n        // Clean form\r\n        resetForm();\r\n        // Show welcome notif\r\n        openNotif(`Bienvenue ${guest.pseudo}, vous pouvez maintenant envoyer vos messages dans ce salon`, \"success\")\r\n        // close choose pseudo form\r\n        closeForm();\r\n        // Set guest peudo in redux state\r\n        setGuestId(savedGuest.id);\r\n      } catch(e) {           \r\n        // Show errors in notif\r\n        const errorList = listServerErrors(e.response.status, e.response.data)\r\n        openNotif(errorList, \"error\")\r\n      }\r\n    }\r\n})(CreateGuestForm);\r\n\r\nexport default CreateGuest;"]},"metadata":{},"sourceType":"module"}