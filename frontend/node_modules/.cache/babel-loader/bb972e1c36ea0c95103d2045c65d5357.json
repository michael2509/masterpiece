{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\micha\\\\Projets\\\\masterpiece\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"C:\\\\Users\\\\micha\\\\Projets\\\\masterpiece\\\\frontend\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import React from'react';import Button from'@material-ui/core/Button';import TextField from'@material-ui/core/TextField';import Dialog from'@material-ui/core/Dialog';import DialogActions from'@material-ui/core/DialogActions';import DialogContent from'@material-ui/core/DialogContent';import DialogContentText from'@material-ui/core/DialogContentText';import DialogTitle from'@material-ui/core/DialogTitle';import*as Yup from\"yup\";import axios from\"axios\";import{withFormik}from'formik';import listServerErrors from'../../global/functions/listServerErrors';function CreateGuestForm(props){var values=props.values,touched=props.touched,errors=props.errors,handleChange=props.handleChange,handleBlur=props.handleBlur,handleSubmit=props.handleSubmit,open=props.open;return React.createElement(\"div\",null,React.createElement(Dialog,{open:open,\"aria-labelledby\":\"form-dialog-title\"},React.createElement(DialogTitle,{id:\"form-dialog-title\"},\"Choix du pseudo\"),React.createElement(DialogContent,null,React.createElement(DialogContentText,null,\"Veuillez choisir le pseudo que vous utiliserez dans ce chat.\"),React.createElement(TextField,{id:\"pseudo\",label:\"Pseudo\",type:\"text\",value:values.pseudo,onChange:handleChange,onBlur:handleBlur,helperText:touched.pseudo?errors.pseudo:\"\",error:touched.pseudo&&Boolean(errors.pseudo),variant:\"outlined\",margin:\"normal\",fullWidth:true,autoFocus:true,required:true})),React.createElement(DialogActions,null,React.createElement(Button,{onClick:handleSubmit,color:\"primary\"},\"Valider\"))));}var CreateGuest=withFormik({mapPropsToValues:function mapPropsToValues(_ref){var pseudo=_ref.pseudo;return{pseudo:pseudo||\"\"};},validationSchema:Yup.object().shape({pseudo:Yup.string().required(\"Entrez un pseudo\")}),handleSubmit:function handleSubmit(values,_ref2){var props,resetForm,chatId,openNotif,closeForm,setSenderName,setSenderType,guest,guestjson,errorList;return _regeneratorRuntime.async(function handleSubmit$(_context){while(1){switch(_context.prev=_context.next){case 0:props=_ref2.props,resetForm=_ref2.resetForm;chatId=props.chatId,openNotif=props.openNotif,closeForm=props.closeForm,setSenderName=props.setSenderName,setSenderType=props.setSenderType;guest=_objectSpread({},values,{chatId:chatId});guestjson=JSON.stringify(guest);console.log(guest);_context.prev=5;_context.next=8;return _regeneratorRuntime.awrap(axios.post(\"http://localhost:8081/api/guests\",guestjson,{headers:{'Content-Type':'application/json'}}));case 8:// Clean form\nresetForm();// Show welcome notif\nopenNotif(\"Bienvenue \".concat(guest.pseudo,\", vous pouvez maintenant envoyer vos messages dans ce chat\"),\"success\");// close choose pseudo form\ncloseForm();// Set guest peudo in redux state\nsetSenderName(guest.pseudo);setSenderType(\"guest\");_context.next=19;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](5);// Show errors in notif\nerrorList=listServerErrors(_context.t0.response.status,_context.t0.response.data);openNotif(errorList,\"error\");case 19:case\"end\":return _context.stop();}}},null,null,[[5,15]]);}})(CreateGuestForm);export default CreateGuest;","map":{"version":3,"sources":["C:/Users/micha/Projets/masterpiece/frontend/src/Chat/SingleChat/CreateGuest.jsx"],"names":["React","Button","TextField","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Yup","axios","withFormik","listServerErrors","CreateGuestForm","props","values","touched","errors","handleChange","handleBlur","handleSubmit","open","pseudo","Boolean","CreateGuest","mapPropsToValues","validationSchema","object","shape","string","required","resetForm","chatId","openNotif","closeForm","setSenderName","setSenderType","guest","guestjson","JSON","stringify","console","log","post","headers","errorList","response","status","data"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport * as Yup from \"yup\";\r\nimport axios from \"axios\";\r\nimport { withFormik } from 'formik';\r\nimport listServerErrors from '../../global/functions/listServerErrors';\r\n\r\nfunction CreateGuestForm(props) {\r\n\r\n  const {\r\n    values,\r\n    touched,\r\n    errors,\r\n    handleChange,\r\n    handleBlur,\r\n    handleSubmit,\r\n    open\r\n  } = props;\r\n\r\n  return (\r\n    <div>\r\n      <Dialog open={open} aria-labelledby=\"form-dialog-title\">\r\n        <DialogTitle id=\"form-dialog-title\">Choix du pseudo</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Veuillez choisir le pseudo que vous utiliserez dans ce chat.\r\n          </DialogContentText>\r\n          <TextField\r\n                    id=\"pseudo\"\r\n                    label=\"Pseudo\"\r\n                    type=\"text\"\r\n                    value={values.pseudo}\r\n                    onChange={handleChange}\r\n                    onBlur={handleBlur}\r\n                    helperText={touched.pseudo ? errors.pseudo : \"\"}\r\n                    error={touched.pseudo && Boolean(errors.pseudo)}\r\n                    variant=\"outlined\"\r\n                    margin=\"normal\"\r\n                    fullWidth\r\n                    autoFocus\r\n                    required\r\n                />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleSubmit} color=\"primary\">\r\n            Valider\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst CreateGuest = withFormik({\r\n  mapPropsToValues: ({\r\n      pseudo\r\n  }) => {\r\n      return {\r\n          pseudo: pseudo || \"\"\r\n      };\r\n  },\r\n\r\n  validationSchema: Yup.object().shape({\r\n      pseudo: Yup.string()\r\n          .required(\"Entrez un pseudo\")\r\n  }),\r\n\r\n  handleSubmit: async (values, { props, resetForm }) => {\r\n\r\n      const { chatId, openNotif, closeForm, setSenderName, setSenderType } = props;\r\n      const guest = {...values, chatId: chatId}\r\n      const guestjson = JSON.stringify(guest);\r\n\r\n      console.log(guest);\r\n\r\n      try {\r\n        // create guest user\r\n        await axios.post(\r\n          \"http://localhost:8081/api/guests\",\r\n          guestjson,\r\n          { headers: { 'Content-Type': 'application/json' } }\r\n        )\r\n\r\n        // Clean form\r\n        resetForm();\r\n        // Show welcome notif\r\n        openNotif(`Bienvenue ${guest.pseudo}, vous pouvez maintenant envoyer vos messages dans ce chat`, \"success\")\r\n        // close choose pseudo form\r\n        closeForm();\r\n        // Set guest peudo in redux state\r\n        setSenderName(guest.pseudo);\r\n        setSenderType(\"guest\")\r\n      } catch(e) {           \r\n        // Show errors in notif\r\n        const errorList = listServerErrors(e.response.status, e.response.data)\r\n        openNotif(errorList, \"error\")\r\n      }\r\n    }\r\n})(CreateGuestForm);\r\n\r\nexport default CreateGuest;"]},"metadata":{},"sourceType":"module"}